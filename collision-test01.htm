<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>RB Framework - Colisao 01</title>

<style type="text/css">
canvas{
	border:1px solid black;
	font-family:'times';
	font-size:30px;
}

</style>
</head>
<body>
<div id="log"></div>
<center>
<canvas id="c" width="400" height="400"></canvas>
</center>

<a href="#" onclick="sc.toggleStart();">stop/start</a>

<script type="text/javascript" src="ragaboom.js"></script>
<script type="text/javascript">

var colorSettings = { h: 20, colors:[ {stopPoint: 0, name: 'rgb(240, 240,240)'}, {stopPoint: 0.5, name: 'silver'} ] };

var tempo = 0;
var loopCount = 0;

var log = RB.el('log');
var tm = RB.el('tempo');

var c = RB.el('c');
var sceneCtx = c.getContext('2d');
var sc = new RB.Scene(c, 24);
sc.rect(400, 400, 'gray', 'bg');
var bg = new RB.Obj('bg', sceneCtx);

sc.text('0', 'arial', 20, colorSettings, 'tempo');
var t = new RB.Obj('tempo', sceneCtx, 60, 350);
t.collidable=true;
t.obstacle=true;

sc.onLoop = function(){
	loopCount++;
	
	if(loopCount == ~~(1000/24)){
		tempo++;
		sc.text(tempo, 'times', 20, colorSettings, 'tempo');
		t.setCanvas('tempo');
		
		loopCount = 0;
	}
}

sc.roundRect(25, 25, 5, 'orange', 'rr');
var rr = new RB.Obj('rr', sceneCtx, 190);
rr.collidable=true;
rr.speedY=5;

rr.fn = function(){
	if( !this.colliding ){
		this.down();
	} else {
		//this.left();
		if(!this.collidingCoords.bottom){
			//this.down();
		}
	}
	
	this.draw();
}

var rr2 = rr.clone();
rr2.x=(90);
rr2.speedY=(1);
rr2.draggable=(true);

sc.rect(400, 20, 'rgba(255, 255, 255, 0.5)', 'chao');
sc.rect(100, 20, 'rgba(255, 255, 255, 0.5)', 'chao2');
sc.rect(100, 20, colorSettings, 'bloco');
sc.roundRect(30, 30, 5, 'rgba(255, 255, 255, 0.88)', 'peca');

var ball;

RB.rtImage('btn_alerta_vermelho.png', 'ball2', function(){});
RB.rtImage('btn_alerta_verde.png', 'ball', function(){
	ball = new RB.Obj('ball', sceneCtx, 20);
	ball.setSprites([ RB.el('ball'), RB.el('ball2')], 5);
	
	ball.collidable=(true);
	ball.draggable=(true);
	ball.speedY=(4);

	ball.fn = function(){
		this.animateSprite();
		
		if( !this.colliding ){
			this.down();
		}
		
		this.draw();
	}
	sc.add(ball);
});

var chao = new RB.Obj('chao', sceneCtx, null, 380);
chao.collidable=(true);
chao.obstacle=(true);

var bloco = new RB.Obj('bloco', sceneCtx, 100, 20);
bloco.draggable=(true);
bloco.collidable=(true);

var peca = new RB.Obj('peca', sceneCtx, 10, 10);
peca.collidable=(true);
peca.obstacle=(true);

sc.addLots([bg, t, rr, rr2, chao, bloco, peca]);
sc.zIndex(bloco, -3);

sc.onmousemove = function(event){
	peca.x=( RB.xPos(event) - (peca.w/2) );
	peca.y=( RB.yPos(event) - (peca.h/2) );
}

</script>

</body>
</html>